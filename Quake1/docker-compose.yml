version: '3.9'

services:
  quake_server:
    image: moisesber/quaken:latest
    platform: linux/amd64
    container_name: quake_server
    ports:
      - "26000:26000/udp"
    volumes:
      - ./quake_data:/nquakesv/id1
      - ./quake_data/maps:/nquakesv/modules
      - ./server.cfg:/nquakesv/id1/server.cfg
    environment:
      - GAME_DIR=id1
      - CONFIG_FILE=server.cfg
    networks:
      - ts_network
    restart: unless-stopped

  tailscale:
    image: tailscale/tailscale:latest
    container_name: tailscale
    cap_add:
      - NET_ADMIN
      - SYS_ADMIN
    environment:
      - TS_AUTH_KEY=tskey-tskey-auth-k5CTz3YNW611CNTRL-CPQKJnYT3qc3nsNXZDAwpcCizPNB2Brs  # Skapa auth key p√• tailscale.com/admin
    volumes:
      - tailscale-var:/var/lib/tailscale
    networks:
      - ts_network
    restart: unless-stopped

volumes:
  tailscale-var:

networks:
  ts_network:
    driver: bridge